<section class="relative overflow-hidden bg-gradient-to-br from-primary-50 via-white to-accent-400/10 py-20 dark:from-gray-950 dark:via-gray-950 dark:to-primary-900/20 sm:py-28">
  <!-- Decorative elements -->
  <div class="pointer-events-none absolute inset-0" aria-hidden="true">
    <div class="absolute -right-20 -top-20 h-72 w-72 rounded-full bg-primary-200/30 blur-3xl dark:bg-primary-400/10"></div>
    <div class="absolute -bottom-16 -left-16 h-64 w-64 rounded-full bg-accent-400/20 blur-3xl dark:bg-accent-500/10"></div>
    <svg class="absolute right-10 top-1/4 hidden text-primary-200/40 dark:text-primary-700/20 lg:block" width="120" height="120" viewBox="0 0 120 120" fill="none">
      <circle cx="10" cy="10" r="3" fill="currentColor" />
      <circle cx="40" cy="10" r="3" fill="currentColor" />
      <circle cx="70" cy="10" r="3" fill="currentColor" />
      <circle cx="100" cy="10" r="3" fill="currentColor" />
      <circle cx="10" cy="40" r="3" fill="currentColor" />
      <circle cx="40" cy="40" r="3" fill="currentColor" />
      <circle cx="70" cy="40" r="3" fill="currentColor" />
      <circle cx="100" cy="40" r="3" fill="currentColor" />
      <circle cx="10" cy="70" r="3" fill="currentColor" />
      <circle cx="40" cy="70" r="3" fill="currentColor" />
      <circle cx="70" cy="70" r="3" fill="currentColor" />
      <circle cx="100" cy="70" r="3" fill="currentColor" />
      <circle cx="10" cy="100" r="3" fill="currentColor" />
      <circle cx="40" cy="100" r="3" fill="currentColor" />
      <circle cx="70" cy="100" r="3" fill="currentColor" />
      <circle cx="100" cy="100" r="3" fill="currentColor" />
    </svg>
  </div>

  <div class="relative mx-auto max-w-5xl px-6">
    <div class="mb-6 inline-flex items-center gap-2 rounded-full border border-accent-400/30 bg-accent-400/10 px-4 py-1.5 text-sm font-medium text-accent-600 dark:border-accent-500/30 dark:bg-accent-500/10 dark:text-accent-400">
      <span class="h-1.5 w-1.5 rounded-full bg-accent-500"></span>
      AI-advies voor het MKB
    </div>
    <h1 class="text-4xl font-bold tracking-tight text-gray-900 dark:text-white sm:text-5xl lg:text-6xl">
      Slimmer ondernemen<br />
      <span class="bg-gradient-to-r from-primary-600 to-primary-400 bg-clip-text text-transparent dark:from-primary-400 dark:to-primary-200">in de Bollenstreek.</span><br />
      Met AI die bij je past.
    </h1>
    <p class="mt-6 text-lg text-gray-500 dark:text-gray-400">
      Voor jou als <span id="typewriter" class="font-semibold text-primary-600 dark:text-primary-400"></span><span id="typewriter-cursor" class="animate-blink text-primary-600 dark:text-primary-400">|</span>
    </p>
    <p class="mt-4 max-w-2xl text-lg text-gray-600 dark:text-gray-300">
      Wij helpen ondernemers in de Duin- en Bollenstreek om knelpunten in hun werk
      zichtbaar te maken en slimmer op te lossen. Concreet, meetbaar en op jouw tempo.
    </p>
    <div class="mt-10 flex flex-col gap-4 sm:flex-row">
      <a
        href="/contact/"
        class="inline-flex items-center justify-center rounded-lg bg-primary-600 px-6 py-3 text-sm font-semibold text-white shadow-lg shadow-primary-600/25 transition-all hover:bg-primary-700 hover:shadow-xl hover:shadow-primary-600/30 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"
      >
        Plan een kennismaking
        <svg class="ml-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </a>
      <a
        href="/ai-scan/"
        class="inline-flex items-center justify-center rounded-lg border border-gray-300 bg-white px-6 py-3 text-sm font-semibold text-gray-700 shadow-sm transition-all hover:border-primary-300 hover:bg-gray-50 hover:text-primary-600 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-200 dark:hover:border-primary-700 dark:hover:bg-gray-800"
      >
        Doe de gratis AI-scan
      </a>
      <button
        id="nee-bedankt"
        type="button"
        class="text-xs text-gray-400 transition-colors hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 sm:self-center"
      >
        Nee bedankt
      </button>
    </div>
  </div>

  <style>
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
    .animate-blink {
      animation: blink 0.7s step-end infinite;
    }
  </style>

  <script>
    const words = [
      "schilder",
      "bloemist",
      "timmerman",
      "horecaondernemer",
      "makelaar",
      "aannemer",
      "installateur",
      "kapper",
      "fysiotherapeut",
      "accountant",
    ];

    const el = document.getElementById("typewriter");
    if (el) {
      let wordIndex = 0;
      let charIndex = 0;
      let deleting = false;

      function tick() {
        const word = words[wordIndex];
        if (!deleting) {
          charIndex++;
          el.textContent = word.slice(0, charIndex);
          if (charIndex === word.length) {
            deleting = true;
            setTimeout(tick, 2000);
            return;
          }
          setTimeout(tick, 80);
        } else {
          charIndex--;
          el.textContent = word.slice(0, charIndex);
          if (charIndex === 0) {
            deleting = false;
            wordIndex = (wordIndex + 1) % words.length;
            setTimeout(tick, 400);
            return;
          }
          setTimeout(tick, 40);
        }
      }

      tick();
    }
  </script>

  <script>
    import Matter from "matter-js";

    const btn = document.getElementById("nee-bedankt");

    btn?.addEventListener("click", () => {
      const { Engine, Bodies, Composite, Body } = Matter;

      // Grab all visible elements, then filter to only "leaf" nodes
      // (elements that don't contain other matched elements)
      const selectors = "h1, h2, h3, h4, p, a, li, ul, ol, img, svg, div, nav, button, form, input, span, section, header, footer";
      const all = Array.from(document.querySelectorAll(selectors)).filter((el) => {
        const rect = el.getBoundingClientRect();
        if (rect.width <= 10 || rect.height <= 10 || rect.bottom <= 0 || rect.top >= window.innerHeight) return false;
        const pos = window.getComputedStyle(el).position;
        if (pos === "fixed" || pos === "sticky") return false;
        return true;
      }) as HTMLElement[];

      // Only take leaf elements â€” skip any element whose child is also in the set
      const elSet = new Set(all);
      const leaves = all.filter((el) => {
        for (const child of el.children) {
          if (elSet.has(child as HTMLElement)) return false;
        }
        return true;
      });

      const engine = Engine.create({ gravity: { x: 0, y: 1 } });
      const items: { el: HTMLElement; body: Matter.Body }[] = [];

      for (const el of leaves) {
        const rect = el.getBoundingClientRect();

        el.style.position = "fixed";
        el.style.left = rect.left + "px";
        el.style.top = rect.top + "px";
        el.style.width = rect.width + "px";
        el.style.height = rect.height + "px";
        el.style.margin = "0";
        el.style.zIndex = "40";
        el.style.pointerEvents = "none";

        const body = Bodies.rectangle(
          rect.left + rect.width / 2,
          rect.top + rect.height / 2,
          rect.width,
          rect.height,
          {
            friction: 0.3,
            restitution: 0.2,
            density: 0.001,
            frictionAir: 0.01,
          }
        );

        Body.setVelocity(body, {
          x: (Math.random() - 0.5) * 2,
          y: 0,
        });

        items.push({ el, body });
        Composite.add(engine.world, body);
      }

      // Floor at viewport bottom, walls at edges
      const thickness = 60;
      Composite.add(engine.world, [
        Bodies.rectangle(window.innerWidth / 2, window.innerHeight + thickness / 2, window.innerWidth * 3, thickness, { isStatic: true }),
        Bodies.rectangle(-thickness / 2, window.innerHeight / 2, thickness, window.innerHeight * 4, { isStatic: true }),
        Bodies.rectangle(window.innerWidth + thickness / 2, window.innerHeight / 2, thickness, window.innerHeight * 4, { isStatic: true }),
      ]);

      document.documentElement.style.overflow = "hidden";
      document.body.style.overflow = "hidden";

      function animate() {
        Engine.update(engine, 1000 / 60);

        for (const { el, body } of items) {
          const w = parseFloat(el.style.width);
          const h = parseFloat(el.style.height);
          el.style.left = body.position.x - w / 2 + "px";
          el.style.top = body.position.y - h / 2 + "px";
          el.style.transform = `rotate(${body.angle}rad)`;
        }

        requestAnimationFrame(animate);
      }

      animate();
    });
  </script>
</section>
